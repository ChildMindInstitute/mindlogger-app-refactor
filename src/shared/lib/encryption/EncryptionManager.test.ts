import { EncryptionManager } from './EncryptionManager';
import { getDefaultEncryptionManager } from './encryptionManagerInstance';
import { IEncryptionManager } from './IEncryptionManager';
import { answerRequestExample } from './mockData';

type TestEncryptionManager = IEncryptionManager & {
  getRandomBytes: EncryptionManager['getRandomBytes'];
};

describe('Encryption', () => {
  let encryptionManager: TestEncryptionManager;

  const privateKey = [1, 2, 3];
  const publicKey = [4, 5, 6];
  const appletPrime = [7, 8, 9];
  const appletBase = [10, 11, 12];

  beforeEach(() => {
    encryptionManager =
      getDefaultEncryptionManager() as never as TestEncryptionManager;

    jest
      .spyOn(encryptionManager, 'getRandomBytes')
      .mockReturnValue(Buffer.alloc(16, 'Mock generate string'));
  });

  describe('getPrivateKey', () => {
    it('should return a valid private key', () => {
      const userId = '123';
      const email = 'test@example.com';
      const password = 'password123';

      const generatedPrivateKey = encryptionManager.getPrivateKey({
        userId,
        email,
        password,
      });

      expect(Array.isArray(generatedPrivateKey)).toBe(true);
      expect(generatedPrivateKey.every(num => typeof num === 'number')).toBe(
        true,
      );
    });
  });

  describe('getPublicKey', () => {
    it('should return a valid public key', () => {
      const generatedPublicKey = encryptionManager.getPublicKey({
        appletPrime,
        appletBase,
        privateKey,
      });

      expect(Array.isArray(generatedPublicKey)).toBe(true);
      expect(generatedPublicKey.every(num => typeof num === 'number')).toBe(
        true,
      );
    });
  });

  describe('getAESKey', () => {
    it('should return a valid AES key', () => {
      const aesKey = encryptionManager.getAESKey({
        privateKey,
        publicKey,
        appletPrime,
        appletBase,
      });

      expect(Array.isArray(aesKey)).toBe(true);
      expect(aesKey.every(num => typeof num === 'number')).toBe(true);
    });
  });

  describe('encryptData', () => {
    it('should return an encrypted string', () => {
      const text = 'Hello, world!';

      const aesKey = encryptionManager.getAESKey({
        privateKey,
        publicKey,
        appletPrime,
        appletBase,
      });

      const encryptedText = encryptionManager.encryptData({
        text,
        key: aesKey,
      });

      expect(typeof encryptedText).toBe('string');
      expect(encryptedText.length).toBeGreaterThan(0);
    });
  });

  describe('decryptData', () => {
    it('should return the decrypted text', () => {
      const encryptedText =
        'cdde8547e1b8a14d0dbefc25dd686aa9:4a0ba43bee825386d40dcc2685cccf2f';

      const aesKey = encryptionManager.getAESKey({
        privateKey,
        publicKey,
        appletPrime,
        appletBase,
      });

      const decryptedText = encryptionManager.decryptData({
        text: encryptedText,
        key: aesKey,
      });

      expect(decryptedText).toBe('Hello, world!');
    });
  });

  describe('getPrivateKey', () => {
    it('should return the private key', () => {
      const result = [
        119, 246, 61, 4, 69, 250, 117, 76, 124, 94, 83, 227, 223, 184, 230, 126,
        252, 194, 122, 167, 138, 161, 129, 226, 125, 229, 100, 32, 41, 219, 255,
        183, 193, 232, 127, 139, 132, 37, 7, 138, 162, 69, 59, 54, 31, 108, 146,
        220, 103, 194, 154, 35, 179, 57, 97, 219, 210, 141, 118, 82, 66, 131,
        194, 237, 14, 117, 143, 233, 157, 169, 111, 173, 6, 235, 26, 233, 23,
        248, 138, 49, 100, 206, 165, 177, 151, 205, 97, 103, 85, 41, 181, 124,
        102, 136, 159, 89, 204, 213, 232, 28, 154, 3, 10, 31, 140, 201, 135, 91,
        2, 129, 40, 210, 175, 162, 44, 241, 89, 178, 78, 98, 148, 11, 241, 144,
        227, 216, 75, 249,
      ];
      const userParams = {
        email: 'linuxweeva@gmail.com',
        password: 'Scope;09',
        userId: '2923f4a9-20ef-4995-a340-251d96ff3082',
      };

      const generatedPrivateKey = encryptionManager.getPrivateKey(userParams);

      expect(generatedPrivateKey).toStrictEqual(result);
    });
  });

  describe('encrypt AnswerRequest', () => {
    it('should return an encrypted string of real answer request', () => {
      const text = JSON.stringify(answerRequestExample);

      const aesKey = encryptionManager.getAESKey({
        privateKey,
        publicKey,
        appletPrime,
        appletBase,
      });

      const encryptedText = encryptionManager.encryptData({
        text,
        key: aesKey,
      });

      const decryptedText = encryptionManager.decryptData({
        text: encryptedText,
        key: aesKey,
      });

      expect(typeof encryptedText).toBe('string');
      expect(decryptedText).toEqual(text);
      expect(encryptedText.length).toBeGreaterThan(0);
    });
  });

  describe('decrypt AnswerRequest', () => {
    it('should return the decrypted answer Request', () => {
      const encryptedText =
        '2bf257dd17948962747bbed2a15a9c7f:3db25b79ca490246db2e5ca3b6b014a78b01cf9dee3bb81a5b0d3b585d1b4f610cdba6ea024030aadc1f390752178a3600d34b852fae19976fff9058f3f8a59b0f9f20be8e68c3cc49c8629c7626033189ab2cea2621e2b9417a0ea9d1eb23687c41a2cf67ad017b595326dc69fc0f2adb0325308fe498227563b92996d602a2080fbc4a76e52261d173f92f9e44ef2667b878d886b27ec06be615cbd6a02dd2bd45147677a0f2925e01941e81a6140656e0ab7e1c035c632f6b67e1b5c6ec0c921c4d5e3e5c4b85b5a236c3058d1bbd75629280d7d7748a7c8b251b05c2f6c853e4453a48737ffe26236e1355bd8d2c7996ab280d40992db2ce4c12de98fc1fc4fe24b0ed8b48553bbc18c7c838c7f665a78927db5b92d5a65d0fd277b98178d91b060c86ecd7997620970765ba8b8ccac6afc8de2b207d8d36569bbe48f65b3d297734ed02ebccadc46a507b27b8432d7fe008ee0fbfcff889d9f75cb16a7c8b29db806b3f31d6810966ff61f205f8c82aae21b33754d935a42531d908148b4089b2bf3f335de5769b4ee607b7ba942f8190f0ff1483fdd301eb82e21b571efa7d5b8a64200148286dbb02a3dd5f7c3943751f8ad773976a30677a472337ded507f387b55ba40092f953717b5586c7e076488574de97b1cef22ea72fa480f813a67dc3447f8bef4a95eb1214303070393bb9790759c8e8682cd5aa31791d038ef0841147f630c4825b0473e765200235410badfa941988a4c769acfd8baf596b178ece7f9cbbb747cb83ed01733deaf3d586378931ac11389099a785840a9b2358346c36035f1c58c00d346087708158ccc8f361e24ea0ba6a2f77f50e8a27528162853ff5b483f69180b55c21e6e153ca2699c8bae14569aea509dfda6d5a11f911f285fec6b9bb2e61948d8021410bfcbf5301443838a2d4eda24c42b3723cbf838acb991c6180a971ba47ff17a350006385a5d76401ebdcba1e048375da42043a22ad0c2e4a64b713ed79207f1d6a17bb120f3639a82fba33be02285f18bb8ad3fe1b2e88f1bf089fd7c6cb37811b0c3a33f48e377b377554a7b193a1ce621c3bec7af5faee8f1c0c3ae4d7e30b112badf6687a7811941cff2b48c24a9e0e43639f14f76bc30df8663e11524b887138d8699b0ccab63bfe45a3a263c4414cd908c208f059a88786333fefbd5a1d882f548ddb57083a5630ee22d84e7e89e1bd79f296fc570c5c7d6dc6b70fd580891ecb92cd420785c4b211ff316b01f9708fee45d42e108863290a9c7ef106684813034db5093bf111c072c92ef913fcc42ccef03b9f9aa0845326ae2c5f45e3b52e75a0e41afb2110109c141fc6672a63426114fcc86e5e1738cb1541ec5b2d1e6bea4c33970d5192ff78a35dd335b44e6523dc91535f69c411500bfb27dfd1e98783bac30dac64cd29a3874429e04839e971fbb80d2a5876780c6e9097196e6e0c6eb28c51ec43c03a26b4be18479d64ed823fad827c825dd431416ea8d658c55387aafffba873bea1f6e70e176a31db65e93f4d2ffc0aa0516f4de8a4202134d3d3e551ec6004e128556f47428d27f60ccc18a2846756b37cf4e1a5e0eb16d8ad611a99543a5dc7673790ab58f67d7daae18886aaad1c9deb80e93af4e9595c0f8eb8581fe1647608787c07066e2e4d90661b276d66958f3599edd2e6e893c7ad6e569bb63d956d2914507763ec1924ee0b962fc0acade023cc85b66f213930ca047cc554acd3d300e4c3ff8db5e3a20a43934c4a054187a59a8f8e463d0b35777f08a7ac2783c8892a14b8657bd7c49442719ac69c4bf9de029af4eb7be2c92832382a472ed4d05023d928a03b61ab142e71374b0f06cad6105948c9ade32e48a548d52bcc5de7f0a9d379b7cf0d00475b3f6f89a26880f4c514dff4fd0d3d95d85c61b4038c7e8eb32adb6d77780d1b856ae2453d601a47e07f8c0e636f6c48d0f980ee854c8addca173c3ce9cd72d9dba1b4d80f6384b1c8143b47936b1b8e8dc16c4a272adbdf70e3bcf9a8545c2689782e184d0432ce0e8d10e30d78a2d4724eb1d114031a95037ef16266c84259173c6732fb531e56407c5b8fd9e64ff5cfe858336d23bda8f65f895a68fa148c03da392e2431b3ec90cd6367576810330aca43ee4ef09c0d897a2ee0284ac053a0eb8fb91a7d62044d750ad7e0010c75266a2bb536a7f64195601e3e207913e4f38183ff6ba8fa86979fa1ddb8622c588294c8fd525964dd1ab427b7e6519852891e9650fba20e26c0a3dd4d115e1faf04cde8ceeb79281754d2a3cea28960ce1d00a796e0cc285abae1155352d35392a19f9cd09a7793546635c802798b44a8f3435a43a6d40148790ff67c74e5d8401d19d755ded19974a88f401c267c14e75cf3e3a7251122def01b89b0bcfdc85f68e1ac79c7cc4219b4b9ec5a629c951a27028d921356b963d0607a8106d7b1737aad6f0d0f4caf9d8335f82c19cd4edc9e524e189d9e4c5b33905f735e548afd6bf99667aaee40a59c00e9a3a1ad735b039ab356a141289a7fc100c2ec05c53a4000042e13264063ef7b709a7814d35fc8aa90f3dccf9d244659163e3b7789d1ebebd96edc0b354df786909e668fb1664f0d8c2bd6e27fef8419346f0ee45b5eeb2a7de117b7fa2f6fa4b561cafa6b626fbdd28fe2c9049312f188f09a67483f74b9da4ddb92215263c865c3ae4d695d2d3ad1ae5d7ed67436d43e45fd1ce2053829e42c63f705d5383ff768da48a248bd8c2623b8d34e1e33060e22c684f2569c54c6fe1b8b408c6189395cac8963ce422cc3be7d14a701cb33f0827eb085e2811fd574cf9f80373c638c2fd5e0008c7d4fcb6424f6f4630e9787c47be26f7ad8daf50d4c205e5c7796cf8887322fd82a73cd6bf019289b4ca1519539b464f7e4c703a89d0b67c84cb74235299b79990d43633b2a58f2b5e54e322f1d9accee6ca4f70ab6a0dbccf9cbffbf2d78f73bf6e13cd38491bf2c599f1b77db07ee73199aa579d512835ce12ac682711d72e6cb4c000d797727c5bfbf41ea34731fc373d90bb377d55c2b8b8ab338a65ca8a6787fac526aa5d99d19f8ce67cef9b65cf14633d1641633f721e478826445600b6cbe1e4eb30d839039552381c84233829a79469a36bdc511ddf8fd2d5da6b40d709e5c179737bb1a56a4f6ae2a05412c1394e9f2cfcece2411bdd43bca42af0a3e91fb41969bd039e5be510297a9a215a09b6d837c2c51325e39c3fd32227906a8d8a9f72e06f4bb6089493a2885bd95a3c9e9104a634b164224b39aa6cc833ca7588a2a18efa1afa168ebb551310cf90286370b569414c8ff5578555a8f79fe8354950d5ecb140b1b9f27cb88e97e40bda5d946aa08dfbbd7b4c3cacb1d2baff6da8739ed93f699d96ed2e3d8651a6811e8ebbb8fbdf6165525878b06f4d869d65064e4f3fa09c8fbec8a107e9a9bec16fa1cc467db59667db3e77c4ea58618e123ba8f4c1d4d1ed265bc50fdf9d4365d47910982e0af479342bd772dcf38fdca8ff8aec6ae21800902cf1da5d347f270d2da5b3e06ed2a7c4890a13ac928289b32a632eeb2fee21541dd16d0988e460f4e04119a5c7d6a3c31089cd0947e8e47231cd0093c0eee79ae7cf970d2889e085af805136cd9236e037b213c1dbded8cdeed9d0434d702309c3662ea2cc7998de84ed3471a36c568e23acbfa4afda9ffd26e1b1012c2fcc108c3f19ed31a610893f776f2188e347280590aa0b4f4a1bb722f60f08a58995cad46cab8ab6960a77489cf8fcbd3551e215db4b645c6c298c454d605c5e74f64a5117d4ac372f7382d2808a5a0a03eff46058fc27a966f87bb182d67ecc32d44c35e5a399f3da84fa2d7ca27ee1baf2581b7b44cfc40325cb4ff86214c54355920a0ea9d0ee1e1f45ff16ff2f6a0289d302398a25dc955b2b3d939c1f050fc70e7202c3206822ab3346307452bc62aea8e64f661c369b2ef3174061b3a561fc595c1a6ed0b7a2e3e4833fe2163d9576f2e53649eaa66f3f245b77435316ac175dfb08496f1aeceb56c0d94b5edb099ebddce3a821d437b0e9326de45917906b868c2fa8568c765ec5c05a278c26d97869d1a8efcea72fbbca17861f24133fb1f553df99aa6b55c3a62c519479857eeb097cb849229fb7de40a23dfcf062ecdb19bffa5f913f421bf56dc1498634fe69494d07af6e6a29a10bf8df40fb4fba000528841bc547c39c3adcbe3b52c557fbc8054cf0958ee3d5d3795616e17190ba481164a5a682a1d288c71399bbb1c7615b73414493e26cc754238cfb7a985faf76dec5e7eacf9fb58301a8d67b309a82f18b2a043fcbebdeee7a14871bb495ff8a26bfe486c9c4acb35fd0a0d5f24a4333078d6341fe74535167b0b4cbd39651d6f3d51cb802f470a10064cf339a71e5e170371332672a191c92d769ba83c06d5d3ec56ee4f82f5f417037c4106cab66a3e8d6758e36775cf0f9fd627e3a77d6dbec644eb414950b132b10a27e97ba94981c6f9b331e09a7d3a688b71e97cf8b5c1bd1e204ef773b266a9f63620fc0b5049d58704e3f550019422f1fba8ea31bfa3d4011f92dce45fd64d50e88ad36a7870dc824c10c6300e0b4aede62c422f997ff88cee344b1d94dd57bb6c6f77f6c4d61c3168727582d5facde92a455e4c51a34899a23158129d68a5d2629bb318f7d95fe23156078517eba9dd6f7a72614981b890e398e2ea5eb1fa159deba0040b892cc58d3f48bfa35859e9b823b3da1db717a5074f8e58488bde63d5e186996c081c389ffede8839bb4fff47540291db8528a6c483270d508beebb36fe47ad3e0f448784592aad8aeee3073df9ce1c0769cb45cb9e10819bc2cb8f475a802517d3f03c011235b5b52fd6e64edfeea712a3c5db2d34399e950b0aa09f5649343346196a24ad89024f831ecd9d6fce6b769c631446cbef9b975cd6bc6b46fb40c9114fe5d0a7a949a17b7f161f6cef9d5a215112fb13028e92ac41e09c78f03c031382bd331b9ba3ab19c49cb68698f3866f6c94372bd01b50e76435f204c5c9cabe6a3ef0054eb2c15f29eace80022f7a256dda53b42b46605fbcde6e9b0a57fcff7d6d97a60caf4c3b31e469828a26df4dbd7b3448100f7e3babdb95fb147020e68794152ed833df70870834a028bd25fe275677cba328fd96620312303d727d6794968b0fb623703950b31a3ad33d0ec12232b0b30ae573444fc3953c235eb6c051eadf448ea2b613dedc4603dea53201bf660e8bd67023ca7b005cef1928642f743f474ed824652bd9837644424a65e606262e61434f1a9338411d0478e5eedf943c5e7871d1192098be52baf9fe2bf1a0766c058621f984b39f55aa3f90a55f9b8e806a77af170222d6f5623c71c8ce51aa794554d28fd63e3725bcfd55c2a58dbe8049725c74b35d40ab3046dc57f79baeb7bf12912734d86c7596d99ebba133c397f153a646ed009816474f1bf09c97fbd3883fc56bebebda894ff912eeab44182a37b5f2e8d8879e76c555806c0cd68b6f7dddd98faa0927e6e5ae8d63419f220476873fe6f1051f8443d5b50d7bc827f8956e58ee3fc4f2ba117970ff04b498db8a4cf97d46c481ff665787d5e20ccbdf808ed4cb897b1dbe4a577c1ef70b924851684370999a76b733cef1a268e98e8e05fa0957255ebed55eef0dffb08cb4d38dda9f7331e90577326102326f7e758b3316b69d070155ad314d435c9a8ab06e000a70a958d2ea5d18db1e1e572776c340479ce82641b7b7243e5a464efe57321493058e02b2073a43088b219300483a1e477a1b3ae416c6b97b624ade0499b2b94b19e00998360caca7c60dd81ada23061a61a26599515e1781342e006e5c102d168de59e2a3bf163c6d94d414847aacb34b773a825d2d6d0ab8aa29537cc96aa9ff117506676fb671f89d36d4bd456866eb51f335a2fc6a75cda1fa25d3ea04edd4e17a7d68b80a51feb902feca321d08aa30e32b0c6e9578706098ae4573870c1570a6b0b6743cfd632d03e84f731cf43f4ae87d983889d36cee2e03f1ed2f2f509bf66770401da29ad3785244669284b980ddff60064adabd5a6d8d62f27a79c82326ae3a0247ed5176e1b793e89a6b594f4d49d02184f8dd4101906cfac5ebd00b4b4a66a3937d361abbdc405d23fbf8883805b394fc803b701e336aa295bc4dc83cccb3699dc59f4fd5e7ca0b191246943b017929044388bf430b7bf329cfdfe13ac06920482929997b641b4fddd525c62663df309329737627b7bcc27dd52cd3c8a022d0b169bf9e088dc1188328b79163fb5ec227d1f6b79f953cb620d05c96f18695180d8ad4fcb10c109ed805fc9a895c50b402879d8208bd64c471367af0da14fce2fe5b92b7bae6b91e08ddda90463b76c72444d2db7070dffbf1024b411473debb3c6bdba7dca7e9edcc3c23a6c10e541ac25a323ac4535455cf8c068b1f876a32f7d4963be80997c7a6ccac65915fd6a14bdb1dbc826f99c6d44a328ce7bd777aae30f33a2dc0d9379a8c138560287d06b7420ed3445c6e204b746d45603dfa96c68a77252969d3e383391b6321c442fbde292eacee17df474752971553154cfcb5832cf588bb7c6b3b90bf37632c829fd1e03d603fdee5a75d781f610d420a629c3596d4fa788010df0fda5e571d4caf29c28188a47d1c77509b73e4ae56a9f55ebec1e7788850be4ebe9a8d8eec335ed51538a69eb3e28bbb6fdfed2f82e36182b9b403442ad1ca62d82d8bd98ab8742f9c444d10f2998a40b7738e5b71fda7fcaaa329d0ed1421101e2fddb8d9c951daf6f34ecd4d183fd5ef7d35a7b9220f17fb9e7f493c4786496352f43e1cbe048214d73e967ee4585310f25f2fda1cec5e254bf2be5f4674757158f1b240fb6cd106fb474260d7d16a80fba1d11aed8281b2414eb7afd8b5e98d36590019682b08d89db8c447e4b9044e786f3888854777691b0c7845d49c46a5e1c4cf56072af535acf51cea93a52ef74363bc262a28538f28e675d5cad79e6df85176885e8a71da42ac51965670895d33dbdec401432bb25e98ea14e9569004abed2bff13b4197a87e8d4361eabb279dde526048339d4312a84c5c3cbaf2d798b91396cf9b6ed37185e2224d94f2628a3202169039b160a372662ae1ab626a44575607fa66d2cef04886791980050fbc9c4c5c35720fb61cc3f173c66cbc456f76308dac465e5a2d4244b48b906b509b56603c61495672ae42dcfc83070ae35ac6464a5d9201294749198333c69b33f22ed093e350b45de91316f215dbca7916b03d24f8a17a9bbc68bb688ff7ce69c95a33a08192c39d201954b33e402d74f17c0c9ab293ff59ca63970748ced86a1d651280c8e96c7f20d34896c2dc82923b9f3d2715596acebf0a97598e89e5092b41d3363ad7eb79707bcb035e398b2c69af90e7526008e2fa0874a7d36dbf8aef2689471743221612ac2407e91780d3f2f452fc8e3c03e5192cf45c86cf2629bc286758dfeb0e0019e8f761805fb11d6f0e47bb8089c05145e564381f28074487d175aec44b97fcc1a44369d70bac628462d766e36224de2f2ebafcbe9ff5968c900220d0c7d4ac2747e4b6a60d9f69e37f982e38318e14b8c67bc285b65a21078887e8bf185393ef700bbd56bc3849f62c04f80e0af256fd8e47855d8b1465abdc1e2f0ad3f8d2be048095c4d8e86dd45b0b1b7732e11e297f7fe734bd6cc7c9609de58bef6c08913dee25d8bc1bfe04e6baa69cdeeaf89e9a1a8ff9482dc0b65e8d52fac0795d15403aa6d067794509d5a5c5d41407a215bf790e833c89a8a566a2fbb8e85215607fbfd9c12460a1bae845d1e312022f326a66f4c73bad6283fe79d04a79aaa2402fb72b23c482dd22d5a9b617eacf0bdb5306387f1743672f01c68475006a0ffda9a2f6a526236280abb474b28a2b7e1bedbc7ff74ec0592307d56168dc9d31e389bc950bb0d9ea7f5e229cc7a6867c35fc79a50344ba120586531eb6d1746863b983f3c8dbdd4876e3074edabdb45512a92f124ae4c02c45746e7d360ebff96a015bf5fbce44585ff431911c3c4961dcace716b73a960d8f1e2eb8c15f53d3039d274315026a37c46f3571af20a572fbecafb5482f6a711502e443ea075c0dfdc59b431118abddb8a90b9c1c45bf254a027a447955b0751a6a3fdf7d9aea1394bcd0a496fcf62712128adc5ca691840f56ef8477416c24d93755c0be9636a58118f35bcdbc1af18c1532e2c1b883b44709e00f62247e60b8709203fba9b747a02601d53ce4ac75e624a88094fad6689bf2701f2e8f3fcf6973dce85688eeac3810a410842e094368ac80a4f72465841d09b0d928142677f1f27ea03f9408a22d3fff5b4fd6e1d32b366a9a3be9520a56a45bc79d7e048fa0aef1b56523ba3876c9e403b894f6195834416b41deb6f024a882178c0c4938f8037bd55777a6a0b322c4d897f6a6956d4ad603764152d0a674fe509d91bef78949660f2b2b60fb13acf36c36b94568a7916fa2fff7a600134c2f3342702c79f3fe80e89a6b471043a74d3881b93886a02416ed53ee6157ebf0cef7b335d1321ec18e01309f4999bceef23554d78754c19d75e5a1e546ce40c7c45eb4b426aca93565bffe0495986afa4ac4b84002361e174c6860d4fa1caef27359e2b022d7b6c937b947a996336222bc4a7e2c2b45294209a7be0c05bac1e51455133e76debb9279f1260461af5cb65a557fc6a97328d4473862306f3aac65db1e80148ea11d867f3f20f4b5ba9a602790ad1add269b7fba220f84bdb286e027ce59bb3a645a7f394138d1532468a747018627e2fa3432d81f48dda977e14815d5eb51151f29391d09f61d722337f69ef876cfc1d62e8ba0e505d74eddfcb55f25f515fe924cc8a05f9959e8262a3bf2ba4619012340084eb9251e362af401e9991a25643ecf8f29f32113671132123b6b7ca657fcfa1289fad0317a0af66a863e380f05f266b1dc98c70f1521bc2cc077e4da649cc886be53bcb1b37e4bbe6c98b248fdc907e6160123bac9689696d9257caa3f85b4bbf4084921964683a61f4477937cce3ae26f17876f89be697e8d4a8c4e7aa51fa792d8fb1fd6c3321f65de88e62e8e95eaeaeca05b17fce62a00c791f10b02d84ed17a90870cad7770feaeaf78e8d4f1f7648ca700ab16ce11794f0629d07cf8fdc63c5b5db94efc89d1204bfbe048b7b979653d48996c8b0244e6d4dd3d7d43723cfcec71d87f90494360065254749446ec62f795f33e961a5d2af685f7ebeb6140ab857ba1b05eda6010762d9bc2a89e694ffa3445e7d27fc4dedae655e0735c68b418c48bbca23acee77af969a0f4ecc62d55d12f817088a4800f95cc19aa097bf46589359b816e33cb005ce10df4a41e5f044c1da57d9f391d225243d7823a6f4543d3a373c2986097f10b8ff29b03c311ad9ad391c7b1c8770fc64fc4b9d2fa5ef11e24f4129d197e44f615f98d3fc873083eb3eaee0a5ea7b15981756ee49e063924838dd8a22fa88c9847f37fb7e409bd6dfdad4fa135a9e8dd856118439e7ae38aa56ec91a9f57724e706701e954f42f6e4c5f81a29ea38cd85e62ca7d8af506e145a8b8fe01e0bc272c5f95c538fabdad154f283f3307750717bb4033f0f11206cf8e8c00e441cfe59c4273e10b589e13713219897e171754acc85856c50bfaf691e2964ba2d0cfd1665ede3f0ad63d8b2ed1124fcd64af6cb97f2279cea9bc72e61439f2c8edd867076f85f1cc39a570aa918f25db3a31c56c7979110b22c4fb424cb3f81c75e3c9956e7fcc6dcf67bb691574784cf216eb93b075adde9990a415955ccef116f1e2f586ef62eb917df8a38d363dff16e772abc497334969b1c6cc7bf3789885f80fdd35c2b4817a3757849e01b0d48478b6b9c27c1b7c416053b1f9cb15726a45de8721c68be6ded1f2e0b2656ca500a2684776ee33ead96fd8c834a58bde55744bbf0eed04f29d29c05a60ec64de44d028e54cae62c88fc878b98b3696cc17e6422b24b89e4b9605415d44d5cf40e4924732a8d0eff42b20763ac5bbd1b05f303f0812a2b4e835f39703090740b67dc4212741b5885374071f990c09b87f9572ff1d5d023bab8102a8c764f8a9f33417e693b8ccad3168c8f46769b9b92c108e913e256d602c17103b88b2ea933fc54de480de8a13468f0130801da3e1a6cf6bc835598d829f636b807c7d750ff0e5b00a1076562908e5b09b4fe61a29fd7bcc6e89c1e95851f8a9ee4c233f5b8a18b72b17822f674bcdce919851056213af86c5c6dd51b42074590190d6ddac1c7e5f12383f61d4914074daeb57fae21e67ba20c823ebcf60fb1aec4fa7ada1ef119241d792407778480f927174190df5cfb8903e00d14268fbf24f345329254793574d80fc54ddc0ec99ad51c842075eb03d3050c9dc9b228bf16001506d25e7858ef009fda54b65ec06ecac2db3b3cb6b4c4c0a8741d533a422ce3e88029d79e703fe18cfa083a66d89f89e8993b6d6a60ebc6f1d323d4e34670889ae774617bf7e81683e90f2809fde70721ab98b8fcc17f451d59a7cd896a205e3b1b28170a60bbafb48f92ab2925ee30a584a7e13f9c7e5b466bb4cd10bfb5c67e1156e85e17127490dde38b7c85559cdaeeac692bdd0da2d5b8b9a20eb4917cd24846267ba03123229d1f428e8ac76b508d624797a0eca0c11e24fd982cc71609c029e8dcdcbec04bf7806172987bb7d75269436ac0e35f28255ffc35ae9fba7a3138c349afe5a98ad4b10e852feb36299b20c56909e39a7efaf1d20de1c9429138dfa1b762fa985fbab77b44373d6fb2883d89acb7bf338eaa821eed48f9cae37d56fc74f01eece391e41c6cdf82dcfd1f5701d09194cea78591123ef9a6fd3d80fc0195e5b580e39cfca487ca73b779e11f47126f1d226ec9df0872b235797333bd598a7cf3e2caa36d3240c9846951ab56e02d69a9c7175fa98ab177124d84fa960cf8c289c120f7570361332e43c876eb78b6b85ed0a3fe5965a717a7f05b1f2e563960cf2a033ada4a9664f2d65a8f7207ac9e116c9671931066175ad8c3ddc01777911aec1c6467156e52077275cbbac0ec54b7b1fb8d31c0e28b5efc3c13db2405e8372cb1963fedc704347b7514281761b4c0f08860775c9f001db7f4bd0139abe193ff00ace3988e55fff62dd1aaf71648fea4e1ed416bab46599390f0566ae9ac66bc175698f50cc4016a5844b19e062aea6c8347a6304c9c6059de8484f062a473b4256ad6ba0ad871127e90fbfbc719ecb47c59ee78c14782f9d123795f2fbac9dfd38803a00ffe4b46517182ae7ba1e1c68504173be5d0159d685ed380411c196f1616ea7df9243e2b9c8a3d90706594f0a67732d61c703d3241a0c3185992f3970a962ad50e87f12c744e9056983a2952da73f88101b2e32cc8d2e4636c35e05a3b1ef747ed5cf3c21063e0a7a993af74e07e98e55300490fe7a327f6147f5218e0cf5ca6588cc2d2de9ce73ef4b7c321cae74291fb746ee0f444ef22ad335281beb3c5caad258ac15c72edb9f6957ef6da6313878fbc517ffc940fc6d1fc7491e5581fcd896dcd4b5bdc3586b1be0c4a78d94c58aa961c87532889736f2711de0d0061106017c8701522b4073c6b3520c21db077eb55043c5a7b2568ccf7b497c8291fffc7ef96a1488d949782a8971bb8ad39cd8c3b38de4f40d057fb848e038f76f85b78c6840fd313c139a5aa6408aae243e6ffdfa8d8160b7179d69fb9fcb3c1093c7f48ee77eea61adbea3693256c85ea21640637801199c00ed75e513ae53a8223d673c72c9a107ac72abb08de13e3c96efdd8f68f12cfac6223fbfb16103a4946f1e771dec28641dcf83179313d226ba8c2ea3c1bbd118a1269e1d3404516603715a13a371e61752168f3422463f795eb5b2c4bd654597b92eda542dd8ac9da2a4b603b8cdb0f765133d3967790ef6a736ff4e574b67df646cc3f840f7eccad7ae2f56095acd8a89fb97cf6d00f800bc5c52c69b9f9a0d950ad2db79c31517873d2d928096d2e781b11107c8fd267aa9f89be06ac0d2a2af36e0c607b4945abd8425c2cadb673063a36e255244a1ded1131825675e3701dcaaae805cdda14398ce0ae2814ab4b37f1560f68aa53a8af32d9f1d0e01b573e044d6f7f9ac2c460ee55d7d8fafb3605177785a3abb64dda5f99b51ffd0cbb5fb664d9ee0efd1f24541912a77b2587cd3923894c76cb9507eb40da89fb9bf21400acd301b1b44841cc2da3c51c10e03e6e3d0bb7933848f7abccbda58fc5f481d12f62d736e9966515fa5e4cf9b3fe8b535466b9d3e4cd4753b2732831cf5a70853761d7c0b8909641c7baf7ef64387ab6a6d33492e0af5adefc3f5e5d73c6954587449d0efd32468e9491c5384529c01ac6b73024c889d5207514f7b2037b7e8b94fc29cff08a543121227b411dc07e1882f826a21c245d2cbacf2fc8fe6ff0518927b50f2e399fc0f0a09a43c809bed2ca240680380423a87a7078595f5066fae4ad8845973ef5e5f5a9c0121f80ebbc0f592009e4696907e243c622116b3561dd26adfd0c3bceead89c28665ecfbab575501cb614f301d939c34b5673e9f78713c85e88db5fe8f9c142562fa32512d9246bb80411b6a3977410b3e6006b43148f7d8bb9fbf53de968ce0660f8b47d0a33ff6dcec8feff7caf8c49c39fb902c2eb6b3000e16172346774658c2ad78375ed47a7af9be7b696e5b42555680d27e43b02c27d469ff9b2acec889678766f0140433ba3c98bdac6d4a44ff4080b577ace33addd5ef6e0bea68468ce43c2b8ae0c861f4aab92ecb5dd5522b68bc6cbbe0996c60be50505e5aa7800a1538201588596ad1dde845df99908a257e3151451e3b0f644f8ed11438071405eabf2cb13fe47b3ef5478748502a77e134d274b803d486654a84f3c0e78856d1c7b2af16215bc344c69eca9d820858e393eaff75274f69ca1658a55c0ae33dd605d134b518087cc5bcffeaa9fc10f5857dc758576e46b169b6e1ea7e2537e701bcc9084c926a6b0b9160da60cb687991bb23f68d1afa043ae8fdcddd2d621f21f0b88e660cb13de000ac019c554b7d579390d7b0413c1aea110f6308ae151297deb89c4e581b83428c73c4158d1497a556423b171d694b08d0263ffa7693dcab43ab68459180cdb7e9e0b6f2c6eee8ce9d87cadcedffffc491b81a8eca366e8ae0a77910a16a0f9c6aa8fafc39d8f5e095de2759032994cb3ce2912cad03decaf15156c2adc729de28d4f3c64c7c67e618c5189eeaa20527e89e2f974ec3b085b04f180afb6dd3e7d416e0c026e1a68e593c1c7f054390968bc2c888625c06f48d2a1c11a22e7bad9ebbe03732e2702ba920364dd9b54198949aeb84056e80c255d14c3844de4d15dd8c4b971371e3204081fbd07b8449d6fc9ad28c8e4d1fd932c1b51d640e1a70a2280d5797b873ab1f4d351461730cdf5c08b29934a45a55901112be5ab22e7a12c79f04dd92eeff3f22dbb9ecca62b84ac775307e21eb5bf97bbf82751dc19860c285f6fa9f19a5bd102dcebb04e04ba871a4811e2507010602d0ddbd9f9e2916c35b96c217c1ce1370474d5d5f467fc284a77e7f4b38899fa14faf22dff8eecc6a24f8eb92d57a37f6f03b6e7dcbfb3ccc96fb2eeb40ee3434d19923a83f2828ad2b772f8d647469273ca00dc7e5896d46760d82558a64496c564a1fc9799b047507c04bbf7276233e7e7c0e14416412eab6e2188755749bfc23afa9a7326f910944357509d65b0349bf0f150e18a8bd7b7de9a4046034e5505030476334e01cd4bf3e8b3201b138eaf84060d7baf0ee8cdb4b0faaa3dc47dcef6e3e1d2dd1055dda295f28e825d5a410cc59eba28d44967ec31744b38516b01c2dd3fad7f3177145d398fea86d58d6f2084b5a1cfb31429d9458b8b1a186027617d56447b83ad4ea21eb2aaf5ab32884704c01afb61a87908e52f037c6dffcdb7b6cc62b37c27f5368fafdce416c715207dbe938bf0120039cd6c6ba5e00403bd293bcc101951366914af868b5d284369cace787b5a75694236f8b9d6364830441d1a3983fe232e6dead3f0da8f13731044f399fd9ab1f2c8f22729cf642fe7cd2c51808394d788f3cb8c9cad264b49ae52cdca7ab52d7e59dbeb9181c51721841bbbe18be3ccb4c7e8021f4db8d26f9c5c47412f0802e85168cdfe5ec8148c379cd1b86f6a31c256e16622854ef5e3930381febdafd0b9d7d0673dabdba9821ff3743837a506f2a61319af0a7ccd67ec911d9a84cf3058d039cbfea923a64220a71a9529dc3ed1da83c553f6662f9232c5f03d44e6ecc3efd16410ae03665f5463506d20f2ee191335c9e3a626b6ba9dd3c9717a8f0417f77d49625e431a1da7c52626a332a66cbe03ae75de592b83ca74e6159f4ea179dc50cc984c3a1da7741e02734422e2a57b1bc72eecfbe0c5d0deff1e9fa40a150f77081c6cf324694e5c929d657c0ca44bda640826e66c8c27652eba0e356fdad735fd812dc59741eae7317e884a3bad4feeade2f3f6675b419235776f7fcbc7600eb18550a23696d9cf5b6da38b711a07b8f442aa033d43111dcca0616a0745473bc82c1a93b987b125ab77822e67ca9e90a54f881f5d1df4903bb5e5717851a4c0ee3ee44ef5be2da8953a8df68627219029f8d2824a910693e5abff6973b6f2930691b76230289ade798511de18c46b30cb195d9fd1768ab9c9079f1c33a16d4aad5e88390b0d34d0eb3a38847dd0ebe6a93803984d9deaedd79dac5547cfbc59687ed427b5701c803289b9091d5e86a0cb97ba8404e0efae6b2beef5d33542063ced6721075634289a543085e8df14aeaae02304185600b0a8c19ed9abb6b9a36520e40c5326d0afd2e5d05d129971cedc2d28352409035688101335609d70d918fd9ace0266df5cb932a54fd6fcaeadc08577fabbf7136e96a5afe9d85c1fb84861bf28c964aeec31a064fb07c8c20cd76093ebda187e144e647552d590cfa3ed8663dfbc62f21e495c7c1bebddcc4431369bbfdc3c3b680873ff0e93302c414521cd3a9e91a41543fd9e7396960ccc8b21183fa8a4204a370311dfa9ca67132e98b364b8842a5f61edce46aa9dd7977ac6b504566655ca4545507d605def171ff4d930575462bba8bc15bd1911658f1babea8b5b63ba5e09acca48dec7e23cbbe0bebd58e2420935d7759347cefb2cab4db72179b15268ca3bbfb4feec5d6deeda952f67faa057266ea0765bca97a35e6a8216e58c959b48ba1ff214fc7d3d3760a567c5286527c960485d89ec7174e8f9901ce2c40295a48d846a3c25723e75e82b6dca9494b2f2e10b8d52b692a7944771e445331618370f37150b3e1ee5e7a2ed4fcd601cce796ecffce31586cbedf09dc437c4af63601c3aa4f0202086db1b9976bf2d0a08cce929388b31c26eeeace5b60dc56054006bd9ee60d37eb9a51b3bdfacf039979856a217b8120df63fce116e9a53f4b32464c21e52490e140df18ff445af3ee9a751729a9b4ab94ae242f1b7e2f85425df648c1bf25ac0daf1e46021b8df0607ffe0d4efd34170b9e46fdc647265f283020abb71e58f0316f8025fc05601bd583744740af385498c080993e4a645b12e578b481fc54611f2459ea53da27f0d3ab39300158706f399688d1141fdd684db5a1043bad24ee64c4c08c17b9973a7b3d61ecb93b34c07157d00256999296252f2e17f51667c627f544073e005186d5ca0fd2f87ebe6312f4922120341de07ec705cdcf47401df3d99e61bc17b1d3da7712f693d71c4b10659f3a964c1b52484e38c01d7dd768b34b78348bc45865803dbd3359b48d8dfdfa2557af8d83652c0b7e0f01d733ffbc1727c003ce73280b6f70f7038e41229397e1825c9226bdbbdb4764bc2e1582acb4a09c7c0d2c6342ba8cd61682e93a216d2679241c675d12d36d36188989a5dafa5520164ad85f0601a03a957a36d941c25aba851f7fd85f5244f56abe6e6a72dcd2b61a41ea5ff22633b57521dc566be3bf624d9932e74f179042eb527afa6fd8c6f7e87ae17ef3b60b185c57ebae5ec393dab94755b58735a6cd69901a71f14320979197acc48ad47824da92b82dc0ae8f4c09af278521b39b8bbc32c27fe32e0f794fef06bff957d8f71911bacd0d79e0043c24a8f528d1a6c906e1193c50095e720c20b3f3ef455afbcbd5431614b8a0572757a4d0dbe2deb514288958369dae1ca9693346b4b798214f1adf62651c7d6464116636d3b299cda4ff637b10a38e70e58de60dccfb03562a26439e68d804f0a52311a78ce43f209b53278e53db24145ade8dafbfc679991d944fc2f2aef3664adcecea517aa544d03c085b4bc8b47f8355b860ca340de454b42d53809d9ff01c1ee69d73b6fbf3279c8c5791fdd3203fb50298c0c152b2a34dd7b5a7504c2540ac64d131aa91480a3f944dc59927f46731ab2159f5d037ad13f7dc010762bd65558c5a6077783b6069a5a802581b0142e29ee4aab1c6827a93b02810a1753d63e1bed91b029231391bf826a81adf0ce04211d36eba6facb98ec8fb150510f954733c1bc1981f8671c507524c22dba38396e6bf3a9c0ed98e327e72fcb8b061dc28c249c60871d6411e85914f553b9e75ad4e141a3d54fda54aa312991d6e4e75dedb16b878e9e45c0fcaedce98789734c08ea8650325565857364c9c878b86ce1f45e861048be6c57f6d13ebe58600e4db5773b24bde0a6e14c046fefaaa9b5c6c76b37edb19ed101ad70648a9c84c872c0fee2cd0e0f9fbae47';

      const aesKey = encryptionManager.getAESKey({
        privateKey,
        publicKey,
        appletPrime,
        appletBase,
      });

      const decryptedText = encryptionManager.decryptData({
        text: encryptedText,
        key: aesKey,
      });

      const originalText = JSON.stringify(answerRequestExample);

      expect(decryptedText).toBe(originalText);
    });
  });
});
